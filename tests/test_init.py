from pytest import mark

from ansiscape import InterpretationDict, interpret
from ansiscape.enums import BlinkSpeed, Intensity, Underline, VerticalPosition


@mark.parametrize(
    "code, expect",
    [
        (
            "",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "-1",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "-1;73",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "0",
            InterpretationDict(
                blink_speed=BlinkSpeed.NONE,
                conceal=False,
                intensity=Intensity.NORMAL,
                invert=False,
                italic=False,
                strike=False,
                underline=Underline.NONE,
                vertical_position=VerticalPosition.NONE,
            ),
        ),
        (
            "1",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=Intensity.BOLD,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "2",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=Intensity.DIM,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "3",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=True,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "4",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=Underline.SINGLE,
                vertical_position=None,
            ),
        ),
        (
            "5",
            InterpretationDict(
                blink_speed=BlinkSpeed.SLOW,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "6",
            InterpretationDict(
                blink_speed=BlinkSpeed.FAST,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "7",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=True,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "8",
            InterpretationDict(
                blink_speed=None,
                conceal=True,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "9",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=True,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "21",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=Underline.DOUBLE,
                vertical_position=None,
            ),
        ),
        (
            "23",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=False,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "24",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=Underline.NONE,
                vertical_position=None,
            ),
        ),
        (
            "25",
            InterpretationDict(
                blink_speed=BlinkSpeed.NONE,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "28",
            InterpretationDict(
                blink_speed=None,
                conceal=False,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "29",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=False,
                underline=None,
                vertical_position=None,
            ),
        ),
        (
            "73",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=VerticalPosition.SUPERSCRIPT,
            ),
        ),
        (
            "74",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=VerticalPosition.SUBSCRIPT,
            ),
        ),
        (
            "75",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=VerticalPosition.NONE,
            ),
        ),
        (
            "73;1",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=Intensity.BOLD,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=VerticalPosition.SUPERSCRIPT,
            ),
        ),
        (
            "0;73",
            InterpretationDict(
                blink_speed=BlinkSpeed.NONE,
                conceal=False,
                intensity=Intensity.NORMAL,
                invert=False,
                italic=False,
                strike=False,
                underline=Underline.NONE,
                vertical_position=VerticalPosition.SUPERSCRIPT,
            ),
        ),
        (
            "73;74",
            InterpretationDict(
                blink_speed=None,
                conceal=None,
                intensity=None,
                invert=None,
                italic=None,
                strike=None,
                underline=None,
                vertical_position=VerticalPosition.SUBSCRIPT,
            ),
        ),
    ],
)
def test_interpret(code: str, expect: InterpretationDict) -> None:
    assert interpret(code) == expect
